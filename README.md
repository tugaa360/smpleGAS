# smpleGAS
ポイントサイト横断｜クレカ案件トラッキング自動化 GAS

---

# 🔖 クレジットカード案件トラッキング自動化ツール for GAS

**主要ポイントサイト**（ハピタス、モッピー、ポイントインカムなど）のクレジットカード案件情報を自動で取得し、**契約記録、解約推奨日の管理、通知**までを一元化する Google Apps Script（GAS）ツールです。

このツールは、以下の課題を**完全に自動化**し、あなたの**ポイ活（ポイント活動）**を強力にサポートします。

* ❌ 毎日、複数のサイトを巡回して案件を探すのが面倒
* ❌ 契約したカードの**解約推奨日を忘れて**、ペナルティのリスクを負ってしまう
* ❌ ポイント付与条件や獲得状況の管理が煩雑

---

## ✨ 主な機能と堅牢性（Why use this?）

このスクリプトは、信頼性とパフォーマンスを最大限に高めています。

| 機能 | 特徴 | 堅牢性 |
| :--- | :--- | :--- |
| **自動ランキング更新** | 毎朝8時に最新のクレジットカード案件情報をスプレッドシートに自動で一覧化します。 | **バッチ更新**で高速化。APIエラー時には管理者に自動通知します。 |
| **高度な日付管理** | 契約日から**月末を考慮**した正確な**解約推奨日**を自動計算します。 | `addMonthsSafely()` 関数により、月末の日付ズレを完全に修正済み。 |
| **ダブルリマインダー** | 解約推奨日の1週間前と当日に**Googleカレンダー登録**と**Gmail通知**を行います。 | **重複登録防止ロジック**（カレンダーフラグと通知済みフラグ）を実装。 |
| **ワンクリック設定** | シート作成、ランキング更新、毎朝の自動実行設定（トリガー）をすべて1つの関数で完了できます。 | ランキング更新と通知の**トリガー実行時間を分散**し、競合を防止します。 |
| **安全性** | 外部APIを利用するため、個人情報や危険なスコープ（`ScriptApp`、`UrlFetchApp`以外）を含まず、安全にご利用いただけます。 | |

---

## 🚀 導入手順（約5分で完了）

### 1. スプレッドシートを作成

任意の **Google スプレッドシート**を新規作成してください。

### 2. GASエディタを開く

スプレッドシート上部メニューから **拡張機能 → Apps Script** を開きます。

### 3. コードの貼り付け

「**📝 GASコード**」セクションにある**全コード**をコピーし、エディタの `コード.gs` に貼り付けて保存します。

### 4. 初回セットアップの実行（重要）

Apps Scriptの画面で、関数ドロップダウンから **`initialSetup`** を選択し、実行ボタン ▶️ をクリックします。

> 🚨 **初回実行時:** Google の権限承認（スコープの承認）を求められます。これは、シート操作、カレンダー登録、メール送信に必要な権限です。

* この実行により、以下の処理が**すべて自動で完了**します。
    * ✅ 「契約管理」シートのテンプレート生成
    * ✅ 「ランキング」シートの初回データ取得
    * ✅ 毎朝7時（メール通知）と8時（ランキング更新）の**自動実行トリガー**を設定

---

## 📅 推奨ワークフロー

システム導入後、日常の運用は以下のシンプルな流れになります。

1.  **毎朝8時:** 「**ランキング**」シートを確認し、最も有利な案件（高報酬、終了間近など）を選びます。
2.  **契約時:** 案件を契約したら、`recordContract()` 関数（または手動で**契約管理シートに記入**）を実行します。
    * *解約推奨日（6ヶ月後など）は自動計算されます。*
3.  **カレンダー登録:** **`registerCancelDateToCalendar()`** を実行し、解約推奨日をカレンダーに登録します。
4.  **通知を待つ:** 解約推奨日の1週間前と当日に、**カレンダーポップアップとメール**が届くので、解約手続きを行います。

---

---

## 🤝 貢献とライセンス

* **ライセンス:** MIT License
* 不具合報告や改善提案は、GitHubの Issue や Pull Request にて歓迎します。
